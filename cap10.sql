
TALUNO
  COD_ALUNO - PK  - CHAVE PRIMARIA -> PRIMARY KEY

TCONTRATO
  COD_ALUNO - PK -> CHAVE PRIMARIA -> PRIMARY KEY
  COD_ALUNO - FK -> CHAVE PRIMARIA QUE VEM DE OUTRA TABELA

SELECT * FROM USER_CONSTRAINTS;

SELECT * FROM ALL_CONSTRAINTS;

CREATE TABLE tcidade(
  cod_cidade INTEGER NOT NULL,
  nome VARCHAR2(40),
  CONSTRAINT pk_cidade PRIMARY KEY(cod_cidade)
);

CREATE TABLE tbairro(
  cod_cidade INTEGER NOT NULL,
  cod_bairro INTEGER NOT NULL,
  nome VARCHAR2(40),
  CONSTRAINT pk_bairro PRIMARY KEY(cod_cidade, cod_bairro)
);

--add chave estrangeira
ALTER TABLE tbairro
ADD CONSTRAINT fk_cod_cidade
FOREIGN KEY (COD_CIDADE)
REFERENCES tcidade(COD_CIDADE);

CREATE TABLE trua(
  cod_rua INTEGER NOT NULL,
  cod_cidade INTEGER,
  cod_bairro INTEGER,
  nome VARCHAR(40),
  CONSTRAINT pk_rua PRIMARY KEY(cod_rua)
);

ALTER TABLE trua
ADD CONSTRAINT fk_cidadebairro
FOREIGN KEY (cod_cidade, cod_bairro)
REFERENCES tbairro(cod_cidade, cod_bairro);

CREATE TABLE tpessoa(
cod_pessoa INTEGER NOT NULL,
tipo VARCHAR2(1) NOT NULL,
nome VARCHAR2(30) NOT NULL,
pessoa VARCHAR2(1) NOT NULL,
cod_rua INTEGER NOT NULL,
cpf VARCHAR2(15),
CONSTRAINT pk_pessoa PRIMARY KEY (cod_pessoa)
);

--unique key
ALTER TABLE TPESSOA ADD CONSTRAINT uk_cpf UNIQUE(CPF);

--alter table tpessoa drop constraint nome constraint
ALTER TABLE TPESSOA ADD CONSTRAINT FK_PESSOA_RUA
FOREIGN KEY (COD_RUA)
REFERENCES TRUA;

--cidade
INSERT INTO TCIDADE VALUES(1, 'NOVO HAMBURGO');
INSERT INTO TCIDADE VALUES(2, 'IVOTI');
INSERT INTO TCIDADE VALUES(3, 'SAPIRANGA');
INSERT INTO TCIDADE VALUES(4, 'TAGUARA');

SELECT *FROM TCIDADE;
SELECT *FROM TBAIRRO;

--Bairro
INSERT INTO TBAIRRO VALUES(1,1, 'CENTRO');
INSERT INTO TBAIRRO VALUES(2,1, 'RIO BRANCO');
INSERT INTO TBAIRRO VALUES(3,1, 'CENTRO');
INSERT INTO TBAIRRO VALUES(4,1, 'FRITZ');
INSERT INTO TBAIRRO VALUES(5,1, 'AMARAL');
INSERT INTO TBAIRRO VALUES 6,1, 'EMPRESA');

--RUA
INSERT INTO TRUA VALUES(1,1,1, 'MARCILIO DIAS');
INSERT INTO TRUA VALUES(2,2,1, 'FRITZ');
INSERT INTO TRUA VALUES(3,3,1, 'JACOBINA');
INSERT INTO TRUA VALUES(4,3,1, 'JOÃO DA SILVA');

--CHECK
ALTER TABLE TPESSOA ADD CONSTRAINT CK_PESSOA_TRIBO
CHECK (TIPO IN ('C', 'F'));

ALTER TABLE TPESSOA ADD CONSTRAINT CK_PESSOA_JF
CHECK (PESSOA IN ('J', 'F'));

--EXCLUIR CONSTRAINT
ALTER TABLE TPESSOA DROP CONSTRAINT NOME_CONSTRAINT;

INSERT INTO TPESSOA VALUES (1, 'C', 'MARCIO', 'F', 1, 1234);
INSERT INTO TPESSOA VALUES (2, 'F', 'BEATRIZ', 'F', 2, 123);
INSERT INTO TPESSOA VALUES (3, 'F', 'PEDRO', 'F', 4, 123);
INSERT INTO TPESSOA VALUES (5, 'C', 'MARIA', 'J', 3, 123);

--foreign key Drop
ALTER TABLE TPESSOA DROP CONSTRAINT NOME_DA_CONSTRAINT
CASCADE CONSTRAINT;

--CHECK
ALTER TABLE TCONTRATO
ADD CONSTRAINT CK_CONTRATO_DESCONTO
CHECK (DESCONTO BETWEEN 0 AND 30);

--DESABILITANDO/HABIITANDO CONSTRAINT
ALTER TABLE TPESSOA DISABLE CONSTRAINT uk_cpf;
ALTER TABLE TPESSOA ENABLE CONSTRAINT uk_cpf;

--exclui Constraint
ALTER TABLE TPESSOA
DROP CONSTRAINT uk_cpf
CASCADE CONSTRAINT;

SELECT * FROM user_constraints
WHERE table_name = 'TPESSOA';

--constraint e as colunas associadas
SELECT constraint_name, column_name
FROM user_cons_columns
WHERE TABLE_name = 'TPESSOA';

SELECT OBJECT_NAME, OBJECT_TYPE
FROM USER_OBJECTS
WHERE OBJECT_NAME IN ('TPESSOA')

SELECT * FROM TPESSOA;

COMMIT;